import{u as T,r as o,j as e}from"./index-DA6Na_pq.js";import{a as C}from"./baseURL-D-lPueBZ.js";import{b as E,a as c}from"./CContainer-Pekuqi4V.js";import{C as R,a as g}from"./CCardBody-6Dx6aIub.js";import{C as Q}from"./CCardHeader-DZP1FFa0.js";import{C as S,a as w,b as u,c as H,d as M,e as N}from"./CTable-BEyfeaqn.js";import{C as k,a as v,b as B,c as I}from"./CModalHeader-ItFSIcCL.js";import{C as L}from"./CModalTitle-CNsi78iC.js";import{C as $}from"./CFormTextarea-DMxNwqfq.js";import"./DefaultLayout-D05Jrs9N.js";import"./index.esm-BxhKCtHB.js";import"./CCloseButton-Dh6QjDBd.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-Byw6dZ_c.js";import"./CFormControlValidation-D2muq1_r.js";import"./CFormLabel-Dr99k2io.js";const _=()=>{const h=T(),{dbname:n,tablename:t}=h.state,[x,p]=o.useState([]),[i,j]=o.useState([]),[f,l]=o.useState(!1),[d,b]=o.useState(""),m=async()=>{try{const a=await C.get(`/${n}/${t}/rows`,{params:{dbname:n}});a.data.length>0&&(j(Object.keys(a.data[0])),p(a.data.slice(1)))}catch(a){console.error("Failed to fetch table data",a),alert("Error loading table data")}};o.useEffect(()=>{m()},[]);const y=async()=>{var a,r;try{const s=await C.post("/execute-sql",{sql:d,dbname:n});alert(s.data.message||"Query executed"),l(!1),m()}catch(s){console.error("Insert failed",s),alert("Query failed: "+((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.error)||s.message)}};return e.jsxs(E,{className:"mt-5",children:[e.jsxs(R,{children:[e.jsxs(Q,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{children:["Table: ",t]}),e.jsx(c,{color:"info",onClick:()=>l(!0),children:"Run SQL Query"})]}),e.jsx(g,{children:e.jsxs(S,{striped:!0,hover:!0,children:[e.jsx(w,{children:e.jsx(u,{children:i.map((a,r)=>e.jsx(H,{children:a},r))})}),e.jsx(M,{children:x.map((a,r)=>e.jsx(u,{children:i.map(s=>e.jsx(N,{children:a[s]},s))},r))})]})})]}),e.jsxs(k,{visible:f,onClose:()=>l(!1),children:[e.jsx(v,{children:e.jsxs(L,{children:["Run SQL Query on ",t]})}),e.jsx(B,{children:e.jsx($,{rows:6,value:d,onChange:a=>b(a.target.value),placeholder:`e.g. INSERT INTO ${t}(name) VALUES('New');
OR UPDATE ${t} SET name='Updated' WHERE id=1;`})}),e.jsxs(I,{children:[e.jsx(c,{color:"secondary",onClick:()=>l(!1),children:"Cancel"}),e.jsx(c,{color:"primary",onClick:y,children:"Run Query"})]})]})]})};export{_ as default};
