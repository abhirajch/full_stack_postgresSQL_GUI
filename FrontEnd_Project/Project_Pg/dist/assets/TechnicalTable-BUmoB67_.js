import{r as t,h as b,u,j as e}from"./index-DA6Na_pq.js";import{a as c}from"./baseURL-D-lPueBZ.js";import{b as x,a as o}from"./CContainer-Pekuqi4V.js";import{C as j,a as y}from"./CRow-i1kvomWg.js";import{C as T,a as g}from"./CCardBody-6Dx6aIub.js";import{C as E}from"./CCardHeader-DZP1FFa0.js";import{C as v,a as w}from"./CListGroupItem-CviFQD5Y.js";import{C as M,a as N,b as R,c as L}from"./CModalHeader-ItFSIcCL.js";import{C as S}from"./CModalTitle-CNsi78iC.js";import{C as k}from"./CFormTextarea-DMxNwqfq.js";import"./DefaultLayout-D05Jrs9N.js";import"./index.esm-BxhKCtHB.js";import"./CCloseButton-Dh6QjDBd.js";import"./cil-user-Dlmw-Gem.js";import"./CFormControlWrapper-Byw6dZ_c.js";import"./CFormControlValidation-D2muq1_r.js";import"./CFormLabel-Dr99k2io.js";const O=()=>{const[d,m]=t.useState([]),[C,r]=t.useState(!1),[l,n]=t.useState(""),p=b(),s=u().state.dbname;console.log(s);const i=async()=>{try{const a=await c.get(`/databasql/tablesses/${s}`);m(a.data.tables)}catch(a){console.error("Error fetching tables:",a),alert("Failed to fetch tables")}};t.useEffect(()=>{s&&i()},[s]);const f=async()=>{try{const a=await c.post("/sql/execute/table",{query:l,database:s});alert("Table created successfully"),r(!1),n(""),i()}catch(a){console.error(a),a.response?(alert(a.response.data.error||"Failed to create table"),a.response.status===403&&alert("Unauthorized action. Please login again.")):alert("Server error")}};return e.jsxs(x,{className:"mt-5",children:[e.jsx(j,{className:"justify-content-center",children:e.jsx(y,{md:10,children:e.jsxs(T,{children:[e.jsxs(E,{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("h5",{children:["Tables in: ",s]}),e.jsx(o,{color:"primary",onClick:()=>r(!0),children:"+ Create Table"})]}),e.jsx(g,{children:e.jsx(v,{children:d.map((a,h)=>e.jsxs(w,{onClick:()=>p("/table-view",{state:{dbname:s,tablename:a}}),style:{cursor:"pointer"},children:["ðŸ§¾ ",a]},h))})})]})})}),e.jsxs(M,{visible:C,onClose:()=>r(!1),children:[e.jsx(N,{onClose:()=>r(!1),children:e.jsxs(S,{children:["Create New Table in ",s]})}),e.jsx(R,{children:e.jsx(k,{rows:6,value:l,onChange:a=>n(a.target.value),placeholder:"CREATE TABLE example (id SERIAL PRIMARY KEY, name TEXT);"})}),e.jsxs(L,{children:[e.jsx(o,{color:"secondary",onClick:()=>r(!1),children:"Cancel"}),e.jsx(o,{color:"primary",onClick:f,children:"Create"})]})]})]})};export{O as default};
